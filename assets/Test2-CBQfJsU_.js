import{n as u}from"./index-CGTLIXey.js";var f=function(){var e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"custom-tree-table"},[n("el-table",{ref:"tableDataRef",attrs:{data:e.tableData,"max-height":"400","row-key":"id",border:"","tree-props":{children:"child"},"default-expand-all":""}},[n("el-table-column",{attrs:{width:"55",align:"center",type:"index",label:"序号"}}),n("el-table-column",{attrs:{label:"参数名",prop:"key","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(o){var t=o.row;return[t.isEdit?n("el-input",{attrs:{placeholder:"请输入"},model:{value:t.key,callback:function(l){e.$set(t,"key",l)},expression:"row.key"}}):n("span",[e._v(e._s(t.key))])]}}])}),n("el-table-column",{attrs:{label:"数据类型",prop:"type","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(o){var t=o.row;return[t.isEdit?n("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{change:function(l){return e.handleDataTypeChange(l,t)}},model:{value:t.type,callback:function(l){e.$set(t,"type",l)},expression:"row.type"}},e._l(e.source.dataTypeOptions,function(l){return n("el-option",{key:l.value,attrs:{value:l.value,label:l.label}})}),1):n("span",[e._v(e._s(t.type))])]}}])}),n("el-table-column",{attrs:{label:"操作","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(o){var t=o.row,l=o.$index;return[n("el-tooltip",{attrs:{"hide-after":e.hideAfter,"open-delay":e.openDelay,effect:"dark",content:"添加",placement:"top"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:function(i){return e.onAddSibling(t,l)}}})],1),t.type==="object"?n("el-tooltip",{attrs:{"hide-after":e.hideAfter,"open-delay":e.openDelay,effect:"dark",content:"添加子节点",placement:"top"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(i){return e.onAddChild(t,l)}}})],1):e._e(),t.isEdit?e._e():n("el-tooltip",{attrs:{"hide-after":e.hideAfter,"open-delay":e.openDelay,effect:"dark",content:"编辑",placement:"top"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(i){return e.onEdit(t,l)}}})],1),t.isEdit?n("el-tooltip",{attrs:{"hide-after":e.hideAfter,"open-delay":e.openDelay,effect:"dark",content:"保存",placement:"top"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-circle-check"},on:{click:function(i){return e.onSave(t,l)}}})],1):e._e(),n("el-tooltip",{attrs:{"hide-after":e.hideAfter,"open-delay":e.openDelay,effect:"dark",content:"删除",placement:"top"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(i){return e.onDelete(t,l)}}})],1)]}}])},[n("template",{slot:"header"},[n("el-tooltip",{staticClass:"item",attrs:{"hide-after":500,effect:"dark",content:"添加根节点",placement:"top"}},[n("el-button",{attrs:{type:"text",icon:"el-icon-circle-plus-outline"},on:{click:e.onAddRoot}})],1)],1)],2)],1)],1)},y=[];const b={name:"CustomTreeTable",data(){return{source:{dataTypeOptions:[{label:"Array",value:"array"},{label:"String",value:"string"},{label:"Boolean",value:"boolean"},{label:"Object",value:"object"},{label:"Number",value:"number"}]},hideAfter:1500,openDelay:500,tableData:[{key:"name",type:"string",child:null},{key:"age",type:"integer",child:null},{key:"response",type:"object",child:[{key:"childrenone",type:"string",child:null},{key:"childrentwo",type:"boolean",child:null}]},{key:"address",type:"string",child:null}]}},created(){this.tableData=this.handleTableDataFormat(this.tableData)},methods:{handleTableDataFormat(e){const a=(n,o)=>{n.forEach(t=>{t.isEdit=!1,t.parentId=o||"0",t.id=this.generateId(),t.child&&t.child.length>0&&a(t.child,t.id)})};return a(e),console.log("Format tableData",e),e},generateId(){return`id_${new Date().getTime()}${Math.floor(Math.random()*1e4)}`},handleDataTypeChange(e,a){a.type=e,this.$set(a,"type",e),e==="object"&&this.$set(a,"child",[])},generateRow(e){return{id:this.generateId(),key:"",type:"",isEdit:!0,parentId:e}},onAddRoot(){this.tableData.push(this.generateRow("0"))},handleAddOneRow(e,a,n){const{parentId:o,id:t}=e,l=n==="SIBLING"?o:t;let i={};const s=h=>{h.forEach(d=>{d.id===l&&(i={...d}),d.child&&d.child.length&&s(d.child)})};s(this.tableData);const{id:c,child:r}=i;r?r.push(this.generateRow(c)):this.$set(i,"child",[this.generateRow(c)])},onAddSibling(e,a){console.log("onAddSibling",e,a);const{parentId:n}=e;n==="0"?this.tableData.push(this.generateRow("0")):this.handleAddOneRow(e,a,"SIBLING")},onAddChild(e,a){this.handleAddOneRow(e,a,"CHILD")},onEdit(e){this.$set(e,"isEdit",!0)},onSave(e){this.$set(e,"isEdit",!1)},onDelete(e){this.$confirm('<div><span style="color: #F56C6C">删除后将不可恢复</span>，你还要继续吗？</div>',"提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,type:"warning"}).then(()=>{const{parentId:n,id:o}=e;if(n==="0"){const t=this.tableData.findIndex(l=>l.id===o);this.tableData.splice(t,1)}else{let t={};const l=c=>{c.forEach(r=>{r.id===n&&(t={...r}),r.child&&r.child.length&&l(r.child)})};l(this.tableData);const{child:i}=t,s=i.findIndex(c=>c.id===o);i.splice(s,1)}}).catch(()=>{})}}},p={};var g=u(b,f,y,!1,v,"70baf3dc");function v(e){for(let a in p)this[a]=p[a]}const _=function(){return g.exports}();export{_ as default};
//# sourceMappingURL=Test2-CBQfJsU_.js.map
